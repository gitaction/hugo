<!doctype html><html lang=zh dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="HugoSites创建 # 当用户配置信息、Hugo默认配置信息，以及根据前面的信息所解析出来的模块信息都准备好后。 Hugo下一步就开始创建站点了：
其中第三步 - 准备hugo文件系统，在原始文件系统的基础上，为Hugo准备好工作目录和发布目录。 真正创建HugoSites的步骤，是第四步。
在 Hugo架构设计中，我们从基础架构的角度对Hugo是如何构建站点进行了分析：
文件系统的组织 以及模板的生命周期 从中，我们了解到，为了让接下来的站点构建专注在构建本身。
Hugo的文件系统需要将不同组件间的逻辑关系都梳理清楚，让多模块中的挂载点都有机的组合在一起，从而能够为其它模块提供便捷的服务。 从下面这张文件系统关系图能看出Hugo对站点领域中文件系统的理解： 模板信息也是在构建站点的时候进行加载的，从开始阶段的领域事件中可以看到： 虽然真正的模块执行阶段在站点渲染阶段，但同上面的文件系统一样，为了提供统一的服务，模块也需要在这之前分工明确，以做好准备。 HugoSites源码实现 # 通过上面的组件分析，有帮助我们理解Hugo的设计理念，和模块组织结构。 为了进一步理解Hugo的具体实现，我们现在从源码出发，看一看Hugo是如何一步步将理念用代码实现的： 从左上角开始，调用NewHugoSites后，主要干了两件事，一个是createSitesFromConfig，另一个则是newHugoSites。
createSitesFromConfig
正是在这里，Hugo创建了Site，而且每个Site都有自己的outputFormats，而这依赖于siteMediaTypesConfig和siteOutputFormatsConfig。
newHugoSites
创建的则是HugoSites。 从两个Site构建顺序和定义来看，HugoSites包含了Site，Site保留有HugoSites的引用：
type Site struct { language *langs.Language // Output formats defined in site config per Page Kind, or some defaults // if not set. // Output formats defined in Page front matter will override these. outputFormats map[string]output.Formats // All the output formats and media types available for this site."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="3.5.3 站点创建"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://hugo.notes.sunwei.xyz/docs/chapter/03/code/site/"><title>3.5.3 站点创建 | Deep Dive into Hugo: Becoming an Expert in the Static Site Generator Domain</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.c58292d36b18b675680ab9baea2029204537b839ea72f258746ec0f32ce8d6c8.css integrity="sha256-xYKS02sYtnVoCrm66iApIEU3uDnqcvJYdG7A8yzo1sg=" crossorigin=anonymous><script defer src=/flexsearch.min.js></script>
<script defer src=/zh.search.min.35de7fc157bc39cdcef2a3b7d8dadeea492103e1ea935a8c216f01e6baf1c4c3.js integrity="sha256-Nd5/wVe8Oc3O8qO32Nre6kkhA+Hqk1qMIW8B5rrxxMM=" crossorigin=anonymous></script>
<script defer src=/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js integrity="sha256-b2+Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC+NdcPIvZhzk=" crossorigin=anonymous></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-STPKPBQR5Y"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-STPKPBQR5Y",{anonymize_ip:!1})}</script><link rel=alternate type=application/rss+xml href=https://hugo.notes.sunwei.xyz/docs/chapter/03/code/site/index.xml title="Deep Dive into Hugo: Becoming an Expert in the Static Site Generator Domain"></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>Deep Dive into Hugo: Becoming an Expert in the Static Site Generator Domain</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=搜索 aria-label=搜索 maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul class=book-languages><li><input type=checkbox id=languages class=toggle>
<label for=languages class="flex justify-between"><a role=button class="flex align-center"><img src=/svg/translate.svg class=book-icon alt=Languages>
Chinese</a></label><ul><li><a href=https://hugo.notes.sunwei.xyz/en/>English</a></li></ul></li></ul><ul><li><p><a href=/docs/introduction/><strong>引言</strong></a><br></p></li><li><p><a href=/docs/chapter/01/><strong>第一章 Hugo入门</strong></a></p><ul><li><a href=/docs/chapter/01/ssg/>1.1 静态站点的背景和重要性</a></li><li><a href=/docs/chapter/01/hugo/>1.2 Hugo简介</a></li><li><a href=/docs/chapter/01/install/>1.3 安装Hugo</a></li><li><a href=/docs/chapter/01/site/>1.4 创建第一个站点</a></li><li><a href=/docs/chapter/01/theme/>1.5 自定义主题</a></li><li><a href=/docs/chapter/01/sunweixyz/>1.6 个人站点实例</a><ul><li><a href=/docs/chapter/01/sunweixyz/site/>个人站点</a></li><li><a href=/docs/chapter/01/sunweixyz/theme/>创建新主题</a></li><li><a href=/docs/chapter/01/sunweixyz/deploy/>部署GitHub Pages</a></li></ul></li><li><a href=/docs/chapter/01/qa/>1.7 常见问题和资源</a><br></li></ul></li><li><p><strong>第二章 DDD简介</strong></p><ul><li><a href=/docs/chapter/02/ddd/>2.1 DDD简介</a></li><li><a href=/docs/chapter/02/dddplayer/>2.2 DDD在本书中的应用</a><br></li></ul></li><li><p><a href=/docs/chapter/03/><strong>第三章 Hugo源码精读</strong></a></p><ul><li><a href=/docs/chapter/03/read/>3.1 源码阅读步骤介绍</a></li><li><a href=/docs/chapter/03/prerequisite/>3.2 Hugo本地环境搭建</a></li><li><a href=/docs/chapter/03/dddplayer/>3.3 安装DDDPlayer</a></li><li><a href=/docs/chapter/03/arch/>3.4 Hugo架构设计</a></li><li><a href=/docs/chapter/03/code/>3.5 Hugo源码精读</a><ul><li><a href=/docs/chapter/03/code/config/>3.5.1 配置</a></li><li><a href=/docs/chapter/03/code/deps/>3.5.2 依赖</a><ul><li><a href=/docs/chapter/03/code/deps/pathSpec/>3.5.2.1 PathSpec</a></li><li><a href=/docs/chapter/03/code/deps/contentSpec/>3.5.2.2 ContentSpec</a></li></ul></li><li><a href=/docs/chapter/03/code/site/ class=active>3.5.3 站点</a><ul><li><a href=/docs/chapter/03/code/site/create/>3.5.3.1 创建</a></li><li><a href=/docs/chapter/03/code/site/load/>3.5.3.2 加载</a></li><li><a href=/docs/chapter/03/code/site/markdown/>3.5.3.3 Markdown</a></li></ul></li><li><a href=/docs/chapter/03/code/build/>3.5.4 构建</a><ul><li><a href=/docs/chapter/03/code/build/template/>3.5.4.1 模板</a><br></li></ul></li></ul></li></ul></li><li><p><a href=/docs/chapter/04/><strong>第四章 DDD Hugo</strong></a></p><ul><li><a href=/docs/chapter/04/hugoverse/>4.1 Hugoverse</a></li><li><a href=/docs/chapter/04/demo/>4.2 Hugo 样例工程</a></li><li><a href=/docs/chapter/04/config/>4.3 DDD Hugo 配置信息</a><br></li></ul></li></ul><ul><li><a href=/posts/>Blog</a></li><li><a href=https://github.com/sunwei/hugo-book target=_blank rel=noopener>Github</a></li><li><a href=https://themes.gohugo.io/hugo-book/ target=_blank rel=noopener>Hugo Themes</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>3.5.3 站点创建</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#hugosites创建>HugoSites创建</a><ul><li><a href=#hugosites源码实现>HugoSites源码实现</a></li><li><a href=#createsitesfromconfig时序图>createSitesFromConfig时序图</a></li><li><a href=#输入语言输出站点>输入语言，输出站点</a></li><li><a href=#createsitesfromconfig动手实践>createSitesFromConfig动手实践</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=hugosites创建>HugoSites创建
<a class=anchor href=#hugosites%e5%88%9b%e5%bb%ba>#</a></h1><p>当用户配置信息、Hugo默认配置信息，以及根据前面的信息所解析出来的模块信息都准备好后。
Hugo下一步就开始创建站点了：</p><p><img src=images/0-main-process.svg alt="Main Process"></p><p>其中第三步 - 准备hugo文件系统，在原始文件系统的基础上，为Hugo准备好工作目录和发布目录。
真正创建HugoSites的步骤，是第四步。</p><p>在
<a href=/docs/chapter/03/arch/>Hugo架构设计</a>中，我们从基础架构的角度对Hugo是如何构建站点进行了分析：</p><ul><li><a href=/docs/chapter/03/arch/#%e6%96%87%e4%bb%b6%e7%b3%bb%e7%bb%9f%e7%9a%84%e7%bb%84%e7%bb%87>文件系统的组织</a></li><li><a href=/docs/chapter/03/arch/#%e6%a8%a1%e6%9d%bf%e7%9a%84%e7%94%9f%e5%91%bd%e5%91%a8%e6%9c%9f>以及模板的生命周期</a></li></ul><p>从中，我们了解到，为了让接下来的站点构建专注在构建本身。</p><p>Hugo的文件系统需要将不同组件间的逻辑关系都梳理清楚，让多模块中的挂载点都有机的组合在一起，从而能够为其它模块提供便捷的服务。
从下面这张文件系统关系图能看出Hugo对站点领域中文件系统的理解：
<img src=images/4.6-hgs-theBigFs.svg alt="Big FS"></p><p>模板信息也是在构建站点的时候进行加载的，从开始阶段的领域事件中可以看到：
<img src=images/6.1.1-template-cycle-start.svg alt="Template Start">
虽然真正的模块执行阶段在站点渲染阶段，但同上面的文件系统一样，为了提供统一的服务，模块也需要在这之前分工明确，以做好准备。
<img src=images/6.1.3-template-cycle-start-and-prepare.svg alt="Template Start and Prepare"></p><h2 id=hugosites源码实现>HugoSites源码实现
<a class=anchor href=#hugosites%e6%ba%90%e7%a0%81%e5%ae%9e%e7%8e%b0>#</a></h2><p>通过上面的组件分析，有帮助我们理解Hugo的设计理念，和模块组织结构。
为了进一步理解Hugo的具体实现，我们现在从源码出发，看一看Hugo是如何一步步将理念用代码实现的：
<img src=images/9.0-Hugo-Sites-main.svg alt="HugoSites Main Process"></p><p>从左上角开始，调用<code>NewHugoSites</code>后，主要干了两件事，一个是<code>createSitesFromConfig</code>，另一个则是<code>newHugoSites</code>。</p><p><strong>createSitesFromConfig</strong></p><p>正是在这里，Hugo创建了Site，而且每个Site都有自己的<code>outputFormats</code>，而这依赖于<code>siteMediaTypesConfig</code>和<code>siteOutputFormatsConfig</code>。</p><p><strong>newHugoSites</strong></p><p>创建的则是HugoSites。
从两个Site构建顺序和定义来看，HugoSites包含了Site，Site保留有HugoSites的引用：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Site</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>language</span>   <span style=color:#f92672>*</span><span style=color:#a6e22e>langs</span>.<span style=color:#a6e22e>Language</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Output formats defined in site config per Page Kind, or some defaults
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// if not set.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// Output formats defined in Page front matter will override these.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>outputFormats</span> <span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#a6e22e>output</span>.<span style=color:#a6e22e>Formats</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// All the output formats and media types available for this site.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// These values will be merged from the Hugo defaults, the site config and,
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// finally, the language settings.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>outputFormatsConfig</span> <span style=color:#a6e22e>output</span>.<span style=color:#a6e22e>Formats</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>mediaTypesConfig</span>    <span style=color:#a6e22e>media</span>.<span style=color:#a6e22e>Types</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// The owning container. When multiple languages, there will be multiple
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// sites .
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>h</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>HugoSites</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// HugoSites represents the sites to build. Each site represents a language.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>HugoSites</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Sites</span> []<span style=color:#f92672>*</span><span style=color:#a6e22e>Site</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>*</span><span style=color:#a6e22e>deps</span>.<span style=color:#a6e22e>Deps</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>在创建HugoSites的过程中，主要要做两件事。
一件是准备好需要惰性初始化的信息，如<code>h.init.data</code>和<code>h.init.layouts</code>，另一件则是应用依赖<code>applyDeps</code>。</p><p>其中重点放在了<code>applyDeps</code>，Hugo将所有需要在渲染前准备好的对象，都称作依赖。
其中包括模板信息、文件系统、站点发布者，站点信息采集者。
从上图也能看出Hugo的创建顺序：</p><ul><li>如果用户没有主动设置模板提供方<code>TemplateProvider</code>，则应用默认模板提供者，并保存在配置信息中。</li><li>新建依赖<code>deps.New</code>，主要是创建出<code>NewPathSpec</code>, <code>NewSpec</code>, <code>NewContentSpec</code>, <code>NewSourceSpec</code>这四个规范，用来简化渲染阶段对文件系统的使用步骤。</li><li>正式创建<code>onCreated</code>，准备好上面的基础信息后，现在需要创建出目标发布器<code>NewDestinationPublisher</code>，初始化站点信息<code>initializeSiteInfo</code>，新建页面收集器<code>newPageCollections</code>。</li><li>加载资源<code>LoadResources</code>，这里加载的资源主要是模板，由上面的模板提供方提供。</li></ul><p>从上面的时序图中，我们了解到Hugo创建HugoSites的主脉络。
接下来让我们将时序图进一步展开，来好好看看各阶段的实现细节。
因为还有很多细节等待着我们去研究，好多疑问需要用这些细节来进行解答。
比如究竟模板是怎么组织的？
这些内置功能函数又是怎么应用上的？
为什么要这么多的文件系统？
都是用来做什么的？</p><p>再用<code>Input -> [?] -> Output</code>模型来进行抽象总结，提取核心思想，化繁为简，真正理解Hugo的设计理念。
最终还是要通过动手实践，用源码解释源码，达到不仅理解，还要会的最终目标。</p><h2 id=createsitesfromconfig时序图>createSitesFromConfig时序图
<a class=anchor href=#createsitesfromconfig%e6%97%b6%e5%ba%8f%e5%9b%be>#</a></h2><p>将<code>createSitesFromConfig</code>进一步展开后，我们得到如下时序图：</p><p><img src=images/9.1-Hugo-Sites-newSite.svg alt="createSitesFromConfig sequence flow"></p><p>可以了解到，Hugo先通过配置信息，准备好多语言实例，然后为每种语言分别生成一个站点。</p><p>在基础架中的
<a href=/docs/chapter/03/arch/#%e9%85%8d%e7%bd%ae%e5%92%8c%e8%af%ad%e8%a8%80%e7%9a%84%e5%85%b3%e7%b3%bb>配置和语言关系</a>栏，我们有介绍配置和语言的关系。
我们先来简单回顾一下：</p><ul><li>在config.toml中提前配置多语言相关信息，包括<code>languageName</code>，<code>contentDir</code>，<code>weight</code>。</li><li>解析完这些自定义信息后，Hugo把这些信息都存放在了<code>config.Provider</code>中，并对外提供了按键值查询的方法。</li><li>在创建站点的时候，先创建语言。通过上面的时序图我们还能进一步了解到，语言对象不仅包含了基础配置信息，还包含了<code>ContentDir</code>和<code>Location</code>等信息。</li></ul><p>总的来看，语言包含了配置信息，以及一些用户自定义的内容相关的关键信息。</p><p>再看上面时序图的右下角，也就是拿到语言信息后，要开始根据语言创建站点了。
在基础架构
<a href=/docs/chapter/03/arch/#%e5%8f%91%e5%b8%83%e7%9a%84%e6%b5%81%e7%a8%8b>站点创建时做的准备工作</a>中，我们有提到创建站点时所需要准备的工作。
包括MediaType, OutputFormat和OutputFormats，他们之间的关联如下图所示：
<img src=images/7.2-publish-start.svg alt="Site Outputs"></p><h2 id=输入语言输出站点>输入语言，输出站点
<a class=anchor href=#%e8%be%93%e5%85%a5%e8%af%ad%e8%a8%80%e8%be%93%e5%87%ba%e7%ab%99%e7%82%b9>#</a></h2><p><img src=images/9.2-Hugo-Sites-newSite-input-output.svg alt="HugoSites input output"></p><p>通过用户配置的语言信息，转换成和语言一一对应的站点，就是<code>createSitesFromConfig</code>所专注的事情。
其中站点Site需要对提供的服务就是针对每种页面类型所提供的<code>OutputFormats</code>，依赖于内部信息<code>Default outputFormats</code>和<code>Default mediaTypes</code>。</p><h2 id=createsitesfromconfig动手实践>createSitesFromConfig动手实践
<a class=anchor href=#createsitesfromconfig%e5%8a%a8%e6%89%8b%e5%ae%9e%e8%b7%b5>#</a></h2><p>在知道<code>createSitesFromConfig</code>的实现原理后，我们再来动动小手，用代码来总结代码，巩固一下知识。</p><p>可以这里线上尝试，
<a href=https://c.sunwei.xyz/create-site.html>Show Me the Code, try it yourself</a></p><p>代码里有注解说明，代码样例：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;strings&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>configProvider</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>DefaultLanguage</span> <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Language manages specific-language configuration.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Language</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Lang</span> <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// If set per language, this tells Hugo that all content files without any
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#75715e>// language indicator (e.g. my-page.en.md) is in this language.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#75715e>// This is usually a path relative to the working dir, but it can be an
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#75715e>// absolute directory reference. It is what we get.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#75715e>// For internal use.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>ContentDir</span> <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Global config.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#75715e>// For internal use.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>Cfg</span> <span style=color:#a6e22e>configProvider</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Site contains all the information relevant for constructing a static
</span></span></span><span style=display:flex><span><span style=color:#75715e>// site.  The basic flow of information is as follows:
</span></span></span><span style=display:flex><span><span style=color:#75715e>//
</span></span></span><span style=display:flex><span><span style=color:#75715e>// 1. A list of Files is parsed and then converted into Pages.
</span></span></span><span style=display:flex><span><span style=color:#75715e>//
</span></span></span><span style=display:flex><span><span style=color:#75715e>//  2. Pages contain sections (based on the file they were generated from),
</span></span></span><span style=display:flex><span><span style=color:#75715e>//     aliases and slugs (included in a pages frontmatter) which are the
</span></span></span><span style=display:flex><span><span style=color:#75715e>//     various targets that will get generated.  There will be canonical
</span></span></span><span style=display:flex><span><span style=color:#75715e>//     listing.  The canonical path can be overruled based on a pattern.
</span></span></span><span style=display:flex><span><span style=color:#75715e>//
</span></span></span><span style=display:flex><span><span style=color:#75715e>//  3. Taxonomies are created via configuration and will present some aspect of
</span></span></span><span style=display:flex><span><span style=color:#75715e>//     the final page and typically a perm url.
</span></span></span><span style=display:flex><span><span style=color:#75715e>//
</span></span></span><span style=display:flex><span><span style=color:#75715e>//  4. All Pages are passed through a template based on their desired
</span></span></span><span style=display:flex><span><span style=color:#75715e>//     layout based on numerous different elements.
</span></span></span><span style=display:flex><span><span style=color:#75715e>//
</span></span></span><span style=display:flex><span><span style=color:#75715e>// 5. The entire collection of files is written to disk.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Site</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>language</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>Language</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Output formats defined in site config per Page Kind, or some defaults
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#75715e>// if not set.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#75715e>// Output formats defined in Page front matter will override these.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>outputFormats</span> <span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#a6e22e>Formats</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// All the output formats and media types available for this site.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#75715e>// These values will be merged from the Hugo defaults, the site config and,
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#75715e>// finally, the language settings.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>outputFormatsConfig</span> <span style=color:#a6e22e>Formats</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>mediaTypesConfig</span>    <span style=color:#a6e22e>Types</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>cusCfg</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>configProvider</span>{
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>DefaultLanguage</span>: <span style=color:#e6db74>&#34;en&#34;</span>,
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>lang</span> <span style=color:#f92672>:=</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>Language</span>{
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Lang</span>:       <span style=color:#a6e22e>cusCfg</span>.<span style=color:#a6e22e>DefaultLanguage</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>ContentDir</span>: <span style=color:#e6db74>&#34;mycontent&#34;</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Cfg</span>:        <span style=color:#a6e22e>cusCfg</span>,
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>mediaTypes</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>DecodeTypes</span>()
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>formats</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>DecodeFormats</span>(<span style=color:#a6e22e>mediaTypes</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>outputFormats</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>createSiteOutputFormats</span>(<span style=color:#a6e22e>formats</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>s</span> <span style=color:#f92672>:=</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>Site</span>{
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>language</span>: <span style=color:#a6e22e>lang</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>outputFormats</span>:       <span style=color:#a6e22e>outputFormats</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>outputFormatsConfig</span>: <span style=color:#a6e22e>formats</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>mediaTypesConfig</span>:    <span style=color:#a6e22e>mediaTypes</span>,
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;Site:&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;%#v\n&#34;</span>, <span style=color:#a6e22e>s</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Type (also known as MIME type and content type) is a two-part identifier for
</span></span></span><span style=display:flex><span><span style=color:#75715e>// file formats and format contents transmitted on the Internet.
</span></span></span><span style=display:flex><span><span style=color:#75715e>// For Hugo&#39;s use case, we use the top-level type name / subtype name + suffix.
</span></span></span><span style=display:flex><span><span style=color:#75715e>// One example would be application/svg+xml
</span></span></span><span style=display:flex><span><span style=color:#75715e>// If suffix is not provided, the sub type will be used.
</span></span></span><span style=display:flex><span><span style=color:#75715e>// See // https://en.wikipedia.org/wiki/Media_type
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Type</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>MainType</span>  <span style=color:#66d9ef>string</span> <span style=color:#e6db74>`json:&#34;mainType&#34;`</span>  <span style=color:#75715e>// i.e. text
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>SubType</span>   <span style=color:#66d9ef>string</span> <span style=color:#e6db74>`json:&#34;subType&#34;`</span>   <span style=color:#75715e>// i.e. html
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>Delimiter</span> <span style=color:#66d9ef>string</span> <span style=color:#e6db74>`json:&#34;delimiter&#34;`</span> <span style=color:#75715e>// e.g. &#34;.&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Type returns a string representing the main- and sub-type of a media type, e.g. &#34;text/css&#34;.
</span></span></span><span style=display:flex><span><span style=color:#75715e>// A suffix identifier will be appended after a &#34;+&#34; if set, e.g. &#34;image/svg+xml&#34;.
</span></span></span><span style=display:flex><span><span style=color:#75715e>// Hugo will register a set of default media types.
</span></span></span><span style=display:flex><span><span style=color:#75715e>// These can be overridden by the user in the configuration,
</span></span></span><span style=display:flex><span><span style=color:#75715e>// by defining a media type with the same Type.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>m</span> <span style=color:#a6e22e>Type</span>) <span style=color:#a6e22e>Type</span>() <span style=color:#66d9ef>string</span> {
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Examples are
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#75715e>// image/svg+xml
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#75715e>// text/css
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>MainType</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/&#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>SubType</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Types is a slice of media types.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Types</span> []<span style=color:#a6e22e>Type</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>defaultDelimiter</span> = <span style=color:#e6db74>&#34;.&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>HTMLType</span> = <span style=color:#a6e22e>newMediaType</span>(<span style=color:#e6db74>&#34;text&#34;</span>, <span style=color:#e6db74>&#34;html&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>newMediaType</span>(<span style=color:#a6e22e>main</span>, <span style=color:#a6e22e>sub</span> <span style=color:#66d9ef>string</span>) <span style=color:#a6e22e>Type</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>t</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>Type</span>{
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>MainType</span>:  <span style=color:#a6e22e>main</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>SubType</span>:   <span style=color:#a6e22e>sub</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Delimiter</span>: <span style=color:#a6e22e>defaultDelimiter</span>}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>t</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// DefaultTypes is the default media types supported by Hugo.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>DefaultTypes</span> = <span style=color:#a6e22e>Types</span>{
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>HTMLType</span>,
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// DecodeTypes takes a list of media type configurations and merges those,
</span></span></span><span style=display:flex><span><span style=color:#75715e>// in the order given, with the Hugo defaults as the last resort.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>DecodeTypes</span>() <span style=color:#a6e22e>Types</span> {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>m</span> <span style=color:#a6e22e>Types</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// remove duplications
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#75715e>// Maps type string to Type. Type string is the full application/svg+xml.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>mmm</span> <span style=color:#f92672>:=</span> make(<span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#a6e22e>Type</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>dt</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>DefaultTypes</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>mmm</span>[<span style=color:#a6e22e>dt</span>.<span style=color:#a6e22e>Type</span>()] = <span style=color:#a6e22e>dt</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>v</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>mmm</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>m</span> = append(<span style=color:#a6e22e>m</span>, <span style=color:#a6e22e>v</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>m</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Format represents an output representation, usually to a file on disk.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Format</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>	<span style=color:#75715e>// The Name is used as an identifier. Internal output formats (i.e. HTML and RSS)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#75715e>// can be overridden by providing a new definition for those types.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>Name</span> <span style=color:#66d9ef>string</span> <span style=color:#e6db74>`json:&#34;name&#34;`</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>MediaType</span> <span style=color:#a6e22e>Type</span> <span style=color:#e6db74>`json:&#34;-&#34;`</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// The base output file name used when not using &#34;ugly URLs&#34;, defaults to &#34;index&#34;.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>BaseName</span> <span style=color:#66d9ef>string</span> <span style=color:#e6db74>`json:&#34;baseName&#34;`</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Formats is a slice of Format.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Formats</span> []<span style=color:#a6e22e>Format</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// GetByName gets a format by its identifier name.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>formats</span> <span style=color:#a6e22e>Formats</span>) <span style=color:#a6e22e>GetByName</span>(
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>name</span> <span style=color:#66d9ef>string</span>) (<span style=color:#a6e22e>f</span> <span style=color:#a6e22e>Format</span>, <span style=color:#a6e22e>found</span> <span style=color:#66d9ef>bool</span>) {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>ff</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>formats</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>strings</span>.<span style=color:#a6e22e>EqualFold</span>(<span style=color:#a6e22e>name</span>, <span style=color:#a6e22e>ff</span>.<span style=color:#a6e22e>Name</span>) {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>f</span> = <span style=color:#a6e22e>ff</span>
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>found</span> = <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// HTMLFormat An ordered list of built-in output formats.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>HTMLFormat</span> = <span style=color:#a6e22e>Format</span>{
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Name</span>:      <span style=color:#e6db74>&#34;HTML&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>MediaType</span>: <span style=color:#a6e22e>HTMLType</span>,
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>BaseName</span>:  <span style=color:#e6db74>&#34;index&#34;</span>,
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// DefaultFormats contains the default output formats supported by Hugo.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>DefaultFormats</span> = <span style=color:#a6e22e>Formats</span>{
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>HTMLFormat</span>,
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// DecodeFormats takes a list of output format configurations and merges those,
</span></span></span><span style=display:flex><span><span style=color:#75715e>// in the order given, with the Hugo defaults as the last resort.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>DecodeFormats</span>(<span style=color:#a6e22e>mediaTypes</span> <span style=color:#a6e22e>Types</span>) <span style=color:#a6e22e>Formats</span> {
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Format could be modified by mediaTypes configuration
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#75715e>// just make it simple for example
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>mediaTypes</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>f</span> <span style=color:#f92672>:=</span> make(<span style=color:#a6e22e>Formats</span>, len(<span style=color:#a6e22e>DefaultFormats</span>))
</span></span><span style=display:flex><span>	copy(<span style=color:#a6e22e>f</span>, <span style=color:#a6e22e>DefaultFormats</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>f</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>createSiteOutputFormats</span>(
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>allFormats</span> <span style=color:#a6e22e>Formats</span>) <span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#a6e22e>Formats</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>defaultOutputFormats</span> <span style=color:#f92672>:=</span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>createDefaultOutputFormats</span>(<span style=color:#a6e22e>allFormats</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>defaultOutputFormats</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> (
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>KindPage</span> = <span style=color:#e6db74>&#34;page&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>kind404</span>  = <span style=color:#e6db74>&#34;404&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>createDefaultOutputFormats</span>(
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>allFormats</span> <span style=color:#a6e22e>Formats</span>) <span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#a6e22e>Formats</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>htmlOut</span>, <span style=color:#a6e22e>_</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>allFormats</span>.<span style=color:#a6e22e>GetByName</span>(<span style=color:#a6e22e>HTMLFormat</span>.<span style=color:#a6e22e>Name</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>m</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#a6e22e>Formats</span>{
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>KindPage</span>: {<span style=color:#a6e22e>htmlOut</span>},
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>kind404</span>:  {<span style=color:#a6e22e>htmlOut</span>},
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>m</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>输出样例：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span> <span style=color:#a6e22e>解析Formats传入的MediaType</span>
</span></span><span style=display:flex><span>[{<span style=color:#a6e22e>text</span> <span style=color:#a6e22e>html</span> .}]
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span> <span style=color:#a6e22e>Site实例</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span> <span style=color:#a6e22e>拥有了语言相关的配置项</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span> <span style=color:#a6e22e>每个页面类型也明确了自己的输出格式</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Site</span>:
</span></span><span style=display:flex><span><span style=color:#f92672>&amp;</span><span style=color:#a6e22e>main</span>.<span style=color:#a6e22e>Site</span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>language</span>:(<span style=color:#f92672>*</span><span style=color:#a6e22e>main</span>.<span style=color:#a6e22e>Language</span>)(<span style=color:#ae81ff>0xc0000161b0</span>),
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>outputFormats</span>:<span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#a6e22e>main</span>.<span style=color:#a6e22e>Formats</span>{
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;404&#34;</span>:<span style=color:#a6e22e>main</span>.<span style=color:#a6e22e>Formats</span>{
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>main</span>.<span style=color:#a6e22e>Format</span>{
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Name</span>:<span style=color:#e6db74>&#34;HTML&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>MediaType</span>:<span style=color:#a6e22e>main</span>.<span style=color:#a6e22e>Type</span>{
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>MainType</span>:<span style=color:#e6db74>&#34;text&#34;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>SubType</span>:<span style=color:#e6db74>&#34;html&#34;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>Delimiter</span>:<span style=color:#e6db74>&#34;.&#34;</span>}, <span style=color:#a6e22e>BaseName</span>:<span style=color:#e6db74>&#34;index&#34;</span>}},
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;page&#34;</span>:<span style=color:#a6e22e>main</span>.<span style=color:#a6e22e>Formats</span>{
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>main</span>.<span style=color:#a6e22e>Format</span>{
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Name</span>:<span style=color:#e6db74>&#34;HTML&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>MediaType</span>:<span style=color:#a6e22e>main</span>.<span style=color:#a6e22e>Type</span>{
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>MainType</span>:<span style=color:#e6db74>&#34;text&#34;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>SubType</span>:<span style=color:#e6db74>&#34;html&#34;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>Delimiter</span>:<span style=color:#e6db74>&#34;.&#34;</span>}, <span style=color:#a6e22e>BaseName</span>:<span style=color:#e6db74>&#34;index&#34;</span>}}},
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>outputFormatsConfig</span>:<span style=color:#a6e22e>main</span>.<span style=color:#a6e22e>Formats</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>main</span>.<span style=color:#a6e22e>Format</span>{
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Name</span>:<span style=color:#e6db74>&#34;HTML&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>MediaType</span>:<span style=color:#a6e22e>main</span>.<span style=color:#a6e22e>Type</span>{
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>MainType</span>:<span style=color:#e6db74>&#34;text&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>SubType</span>:<span style=color:#e6db74>&#34;html&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Delimiter</span>:<span style=color:#e6db74>&#34;.&#34;</span>}, <span style=color:#a6e22e>BaseName</span>:<span style=color:#e6db74>&#34;index&#34;</span>}},
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mediaTypesConfig</span>:<span style=color:#a6e22e>main</span>.<span style=color:#a6e22e>Types</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>main</span>.<span style=color:#a6e22e>Type</span>{<span style=color:#a6e22e>MainType</span>:<span style=color:#e6db74>&#34;text&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>SubType</span>:<span style=color:#e6db74>&#34;html&#34;</span>, <span style=color:#a6e22e>Delimiter</span>:<span style=color:#e6db74>&#34;.&#34;</span>}}}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Program</span> <span style=color:#a6e22e>exited</span>.
</span></span></code></pre></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/sunwei/hugo-notes/commit/1d95a266b0290ad7b3b4459d6bd478659f3d12e9 title='最后修改者 sunwei | November 20, 2023' target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt=Calendar>
<span>November 20, 2023</span></a></div><div><a class="flex align-center" href=https://github.com/sunwei/hugo-notes/edit/main/content.zh/docs/chapter/03/code/site/_index.md target=_blank rel=noopener><img src=/svg/edit.svg class=book-icon alt=Edit>
<span>编辑本页</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#hugosites创建>HugoSites创建</a><ul><li><a href=#hugosites源码实现>HugoSites源码实现</a></li><li><a href=#createsitesfromconfig时序图>createSitesFromConfig时序图</a></li><li><a href=#输入语言输出站点>输入语言，输出站点</a></li><li><a href=#createsitesfromconfig动手实践>createSitesFromConfig动手实践</a></li></ul></li></ul></nav></div></aside></main></body></html>