<!doctype html><html lang=zh dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Hugo 游乐场 # 使用Hugo构建站点的体验很棒。 首先是构建速度快，其次是使用起来简单，一个hugo命令，我们的站点就已经就绪。
在构建过程中，Hugo提供了丰富的内置功能函数，可以在构建过程中向你提供所需要的几乎任何站点相关的信息。 通过可重用模板，让主题来帮助处理所有展示和布局相关的问题。 让作者更专注在内容的创作上。
游乐场 # 站点构建的就将写好的内容，转化成Web服务器能理解的网站资源。 比如我们写作的时候用的是Markdown格式，生成的网站资源通常是HTML格式。
下面是一个简单的初始化博客内容：
-- config.toml -- theme = &#34;mytheme&#34; contentDir = &#34;mycontent&#34; -- myproject.txt -- Hello project! -- themes/mytheme/mytheme.txt -- Hello theme! -- mycontent/blog/post.md -- --- title: &#34;Post Title&#34; --- ### first blog Hello Blog -- layouts/index.html -- {{ $entries := (readDir &#34;.&#34;) }} START:|{{ range $entry := $entries }}{{ if not $entry.IsDir }}{{ $entry.Name }}|{{ end }}{{ end }}:END: -- layouts/_default/single."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content><meta property="og:description" content="Hugo 游乐场 # 使用Hugo构建站点的体验很棒。 首先是构建速度快，其次是使用起来简单，一个hugo命令，我们的站点就已经就绪。
在构建过程中，Hugo提供了丰富的内置功能函数，可以在构建过程中向你提供所需要的几乎任何站点相关的信息。 通过可重用模板，让主题来帮助处理所有展示和布局相关的问题。 让作者更专注在内容的创作上。
游乐场 # 站点构建的就将写好的内容，转化成Web服务器能理解的网站资源。 比如我们写作的时候用的是Markdown格式，生成的网站资源通常是HTML格式。
下面是一个简单的初始化博客内容：
-- config.toml -- theme = &#34;mytheme&#34; contentDir = &#34;mycontent&#34; -- myproject.txt -- Hello project! -- themes/mytheme/mytheme.txt -- Hello theme! -- mycontent/blog/post.md -- --- title: &#34;Post Title&#34; --- ### first blog Hello Blog -- layouts/index.html -- {{ $entries := (readDir &#34;.&#34;) }} START:|{{ range $entry := $entries }}{{ if not $entry.IsDir }}{{ $entry.Name }}|{{ end }}{{ end }}:END: -- layouts/_default/single."><meta property="og:type" content="article"><meta property="og:url" content="https://hugo.notes.sunwei.xyz/docs/how/%E6%B8%B8%E4%B9%90%E5%9C%BA/"><meta property="article:section" content="docs"><title>Index | Deep Understanding of Hugo</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=alternate hreflang=en href=https://hugo.notes.sunwei.xyz/en/docs/how/%E6%B8%B8%E4%B9%90%E5%9C%BA/ title=Index><link rel=stylesheet href=/book.min.c58292d36b18b675680ab9baea2029204537b839ea72f258746ec0f32ce8d6c8.css integrity="sha256-xYKS02sYtnVoCrm66iApIEU3uDnqcvJYdG7A8yzo1sg=" crossorigin=anonymous><script defer src=/flexsearch.min.js></script>
<script defer src=/zh.search.min.1ecc359d6bd3fe3a685cff1b637cce441a384b9cb4f84087d4cd56e5ecb09365.js integrity="sha256-Hsw1nWvT/jpoXP8bY3zORBo4S5y0+ECH1M1W5eywk2U=" crossorigin=anonymous></script>
<script defer src=/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js integrity="sha256-b2+Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC+NdcPIvZhzk=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>Deep Understanding of Hugo</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=搜索 aria-label=搜索 maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul class=book-languages><li><input type=checkbox id=languages class=toggle>
<label for=languages class="flex justify-between"><a role=button class="flex align-center"><img src=/svg/translate.svg class=book-icon alt=Languages>
Chinese</a></label><ul><li><a href=https://hugo.notes.sunwei.xyz/en/docs/how/%E6%B8%B8%E4%B9%90%E5%9C%BA/>English</a></li></ul></li></ul><ul><li><p><strong>Hugo使用实例</strong></p></li><li><p><a href=/docs/what/%E4%B8%AA%E4%BA%BA%E7%AB%99%E7%82%B9/>创建站点</a></p></li><li><p><a href=/docs/what/%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%BB%E9%A2%98/>自定义主题</a><br></p></li><li><p><strong>Hugo架构</strong></p></li><li><p><a href=/docs/how/%E6%B8%B8%E4%B9%90%E5%9C%BA/ class=active>游乐场</a></p></li><li><p><a href=/docs/how/%E4%BA%8B%E4%BB%B6%E9%A3%8E%E6%9A%B4/>事件风暴</a></p></li><li><p><a href=/docs/how/%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84/>基础架构</a><br></p></li><li><p><a href=/docs/code/><strong>源码解析</strong></a></p></li><li><p><a href=/docs/code/%E9%85%8D%E7%BD%AE/>配置</a></p></li><li><p><a href=/docs/code/%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86/>依赖管理</a></p><ul><li><a href=/docs/code/%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86/%E8%B7%AF%E5%BE%84%E8%A7%84%E8%8C%83/>PathSpec</a></li><li><a href=/docs/code/%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86/%E5%86%85%E5%AE%B9%E8%A7%84%E8%8C%83/>ContentSpec</a></li></ul></li><li><p><a href=/docs/code/%E7%AB%99%E7%82%B9/>站点创建</a></p><ul><li><a href=/docs/code/%E7%AB%99%E7%82%B9/%E5%88%9B%E5%BB%BA/>创建站点</a></li><li><a href=/docs/code/%E7%AB%99%E7%82%B9/%E5%8A%A0%E8%BD%BD%E8%B5%84%E6%BA%90/>加载资源</a></li><li><a href=/docs/code/%E7%AB%99%E7%82%B9/markdown/>Markdown</a></li></ul></li><li><p><a href=/docs/code/%E6%9E%84%E5%BB%BA/>站点构建</a></p><ul><li><a href=/docs/code/%E6%9E%84%E5%BB%BA/%E6%A8%A1%E6%9D%BF/>模板执行</a><br></li></ul></li></ul><ul><li><a href=/posts/>Blog</a></li><li><a href=https://github.com/sunwei/hugo-book target=_blank rel=noopener>Github</a></li><li><a href=https://themes.gohugo.io/hugo-book/ target=_blank rel=noopener>Hugo Themes</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Index</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#hugo-游乐场>Hugo 游乐场</a><ul><li><a href=#游乐场>游乐场</a><ul><li><a href=#站点首页>站点首页</a></li><li><a href=#博客页面>博客页面</a></li><li><a href=#show-me-the-code>Show Me The Code</a></li></ul></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=hugo-游乐场>Hugo 游乐场
<a class=anchor href=#hugo-%e6%b8%b8%e4%b9%90%e5%9c%ba>#</a></h1><p>使用Hugo构建站点的体验很棒。
首先是构建速度快，其次是使用起来简单，一个<code>hugo</code>命令，我们的站点就已经就绪。</p><p>在构建过程中，Hugo提供了丰富的内置功能函数，可以在构建过程中向你提供所需要的几乎任何站点相关的信息。
通过可重用模板，让主题来帮助处理所有展示和布局相关的问题。
让作者更专注在内容的创作上。</p><h2 id=游乐场>游乐场
<a class=anchor href=#%e6%b8%b8%e4%b9%90%e5%9c%ba>#</a></h2><p>站点构建的就将写好的内容，转化成Web服务器能理解的网站资源。
比如我们写作的时候用的是Markdown格式，生成的网站资源通常是HTML格式。</p><p>下面是一个简单的初始化博客内容：</p><pre tabindex=0><code>-- config.toml --
theme = &#34;mytheme&#34;
contentDir = &#34;mycontent&#34;
-- myproject.txt --
Hello project!
-- themes/mytheme/mytheme.txt --
Hello theme!
-- mycontent/blog/post.md --
---
title: &#34;Post Title&#34;
---
### first blog
Hello Blog
-- layouts/index.html --
{{ $entries := (readDir &#34;.&#34;) }}
START:|{{ range $entry := $entries }}{{ if not $entry.IsDir }}{{ $entry.Name }}|{{ end }}{{ end }}:END:
-- layouts/_default/single.html --
{{ .Content }}
===
Static Content
===
</code></pre><p>可以看到我们自定义了一个主题<strong>mytheme</strong>，只有一个mytheme.txt文件，并没有实际的模板文件。
这将会在下面的构建流程讲解中，帮助我们理解到主题是如何嵌套和加载的。</p><p>我们的内容文件夹是<strong>mycontent</strong>，在blog目录下有一篇简单博文/blog/post.md。
如果想要独立访问这篇博文，就需要为她生成一个HTML文件，这样我们就可以在浏览器中访问了。</p><p>在样例中，为了生成首页和博客，我们还在layouts下创建了两个模板。
一个是首页模板index.html，另一个则是单篇文章会用到的模板_default/single.html。</p><p>通过golang tools txtar解析上述文本，方便我们转换成如下结构的磁盘文件：</p><pre tabindex=0><code>.
├── config.toml
├── layouts
│  ├── _default
│  │   └── single.html
│  └── index.html
├── mycontent
│   └── blog
│     └── post.md
├── myproject.txt
└── themes
    └── mytheme
        └── mytheme.txt
</code></pre><p>通过Hugo命令进行构建，就能生成如下站点资源：</p><pre tabindex=0><code>➜  public tree
.
├── blog
│   └── index.html
├── index.html
└── robots.txt
</code></pre><p>并包含了我们想要的信息：</p><h3 id=站点首页>站点首页
<a class=anchor href=#%e7%ab%99%e7%82%b9%e9%a6%96%e9%a1%b5>#</a></h3><pre tabindex=0><code>➜  public cat index.html

START:|config.toml|myproject.txt|:END:%
</code></pre><h3 id=博客页面>博客页面
<a class=anchor href=#%e5%8d%9a%e5%ae%a2%e9%a1%b5%e9%9d%a2>#</a></h3><pre tabindex=0><code>➜  public cat blog/index.html
&lt;h3 id=&#34;first-blog&#34;&gt;first blog&lt;/h3&gt;
&lt;p&gt;Hello Blog&lt;/p&gt;

===
Static Content
===

  %
</code></pre><p>那Hugo的这个魔术到底是怎么变出来的呢？</p><p>为了了解Hugo构建的核心原理，通过对Hugo最新源码进行裁剪，移除当前阶段不必要的"噪音"。
结合我们上面的实例，手动生成了一个最小可工作源码库 -
<a href=https://github.com/gitaction/hugo-palyground>hugo游乐场</a>。
以保证我们在这个游乐场可以尽情地玩耍，专注于核心原理，享受整个源码的学习过程。</p><p>通过命令:</p><pre tabindex=0><code>git ls-files | grep &#39;\.go&#39; | xargs wc -l
</code></pre><p>分别统计
<a href=https://github.com/gohugoio/hugo>gohugoio/hugo</a>和
<a href=https://github.com/gitaction/hugo-palyground>hugo playground</a>的代码行数。
我们得到的数据分别是 <strong>163075</strong> 和 <strong>33990</strong> 行。</p><p><strong>整整缩减了近四倍！</strong></p><p>相信各位看官也会虎躯一震，信心倍增！看源码原来也可以这么开心。
请准备好瓜子饮料小板凳，各位看官你细听分说。</p><h3 id=show-me-the-code>Show Me The Code
<a class=anchor href=#show-me-the-code>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;bytes&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;path/filepath&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;golang.org/x/tools/txtar&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 文件结构
</span></span></span><span style=display:flex><span><span style=color:#75715e>// 文件名: config.toml
</span></span></span><span style=display:flex><span><span style=color:#75715e>// 文件内容：theme = &#39;mytheme&#39;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>files</span> = <span style=color:#e6db74>&#34;-- config.toml --\n&#34;</span> <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;theme = &#39;mytheme&#39;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 解析上面的文件结构
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>data</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>txtar</span>.<span style=color:#a6e22e>Parse</span>([]byte(<span style=color:#a6e22e>files</span>))
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;File start:&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// 遍历解析生成的所有文件，通过File结构体获取文件名和文件数据
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#75715e>// f.Name 获取文件名
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#75715e>// f.Data 获取文件数据
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>f</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>Files</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>filename</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>filepath</span>.<span style=color:#a6e22e>Join</span>(<span style=color:#e6db74>&#34;workingDir&#34;</span>, <span style=color:#a6e22e>f</span>.<span style=color:#a6e22e>Name</span>)
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>data</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>bytes</span>.<span style=color:#a6e22e>TrimSuffix</span>(<span style=color:#a6e22e>f</span>.<span style=color:#a6e22e>Data</span>, []byte(<span style=color:#e6db74>&#34;\n&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>filename</span>)
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(string(<span style=color:#a6e22e>data</span>))
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;File end.&#34;</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Output:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span># 解析后得到文件config.toml，以及下面的文件内容
</span></span><span style=display:flex><span># workingDir就是我们的工作目录，通常是要写入的文件目录
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>File start:
</span></span><span style=display:flex><span>workingDir/config.toml
</span></span><span style=display:flex><span>theme = &#39;mytheme&#39;
</span></span><span style=display:flex><span>File end.
</span></span></code></pre></div><p><a href=https://c.sunwei.xyz/txtar.html>Try it yourself</a></p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/sunwei/hugo-notes/edit/main/content.zh/docs/how/%e6%b8%b8%e4%b9%90%e5%9c%ba/index.md target=_blank rel=noopener><img src=/svg/edit.svg class=book-icon alt=Edit>
<span>编辑本页</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#hugo-游乐场>Hugo 游乐场</a><ul><li><a href=#游乐场>游乐场</a><ul><li><a href=#站点首页>站点首页</a></li><li><a href=#博客页面>博客页面</a></li><li><a href=#show-me-the-code>Show Me The Code</a></li></ul></li></ul></li></ul></nav></div></aside></main></body></html>